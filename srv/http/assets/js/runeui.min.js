var GUI={DBentry:["","",""],DBupdate:0,activePlayer:"",browsemode:"file",checkvol:0,currentDBpos:[0,0,0,0,0,0,0,0,0,0,0],currentDBpath:["","","","","","","","","","",""],currentalbum:null,currentknob:null,currentpath:"",currentsong:null,json:0,libraryhome:"",forceGUIupdate:false,maxvol:100,minvol:0,mode:"websocket",noticeUI:{},playlist:null,plugin:"",state:"",old_state:"none",stepVolumeDelta:0,stepVolumeInt:0,stream:"",visibility:"visible",vol_changed_local:0,volume:null,clientUUID:null};function generateUUID(){var b=new Date().getTime();var a="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var d=(b+Math.random()*16)%16|0;b=Math.floor(b/16);return(e=="x"?d:(d&3|8)).toString(16)});return a}function sendCmd(a){$.ajax({type:"GET",url:"/command/?cmd="+a+"&clientUUID="+GUI.clientUUID,cache:false})}function checkWebSocket(){if(window.WebSocket){return"websocket"}else{return"longpolling"}}function checkWorkers(){if((window.Worker&&window.Blob)||(Modernizr.webworkers&&Modernizr.blobconstructor)){return true}else{return false}}function parsePath(c){var a=c&&c.length?c.lastIndexOf("/"):0;var b="";if(a&&a!==-1){b=c.slice(0,a)}return b}var idleTime=0;var viewScreenSaver=0;var widthScreenSaver=0;var isLocalHost=0;var SStime=-1;$(document).ready(function(){GUI.clientUUID=generateUUID();if($("#section-index").length){if(location.hostname==="localhost"||location.hostname==="127.0.0.1"){isLocalHost=1;SStime=localSStime}else{isLocalHost=0;SStime=remoteSStime}if(SStime>=0){var a=setInterval(timerIncrement,1000)}$(this).on("mousemove click keypress",function(b){idleTime=0;if(viewScreenSaver){$(".tab-content").show("slow");$(".screen-saver-content").hide("slow");$("#menu-bottom").show("slow");$("#menu-top").show("slow");viewScreenSaver=0}})}});function timerIncrement(){if($("#section-index").length&&GUI.state==="play"){idleTime=idleTime+1}else{idleTime=0}if(idleTime>SStime){$(".tab-content").hide("slow");$(".screen-saver-content").show("slow");$("#menu-bottom").hide("slow");$("#menu-top").hide("slow");viewScreenSaver=1}}function refreshTimer(d,a,c){var e=$("#countdown-display");e.countdown("destroy");e.countdown({since:((c!=="stop"||c!==undefined)?-(d):0),compact:true,format:"MS"});if(c!=="play"){e.countdown("pause")}var b=$("#countdown-display-ss");b.countdown("destroy");b.countdown({since:((c!=="stop"||c!==undefined)?-(d):0),compact:true,format:"MS"});if(c!=="play"){b.countdown("pause")}}function refreshKnob(){window.clearInterval(GUI.currentKnob);var a=parseInt(GUI.json.song_percent)*10;var d=parseInt(GUI.json.time);var b=parseInt(1000/d);var c=$("#time");c.val(a,false).trigger("update");if(GUI.state==="play"){GUI.currentKnob=setInterval(function(){a=a+((GUI.visibility!=="visible")?b:1);c.val(a,false).trigger("update")},d)}}function timeConvert(d){var b=Math.floor(d/60);d-=b*60;var c=(b<10)?("0"+b):b;var a=(d<10)?("0"+d):d;return c+":"+a}function timeConvert2(a){var b=Math.floor(a/3600);var c=Math.floor((a-(b*3600))/60);a=Math.floor(a-(b*3600)-(c*60));if(b>0){if(b<10){b="0"+b}b+=":"}else{b=""}if(c<10){c="0"+c}if(a<10){a="0"+a}return b+c+":"+a}function timeConvert3(a){var b=Math.floor(a/3600);var c=Math.floor((a-(b*3600))/60);a=Math.floor(a-(b*3600)-(c*60));if(b>0){if(b<10){b="0"+b+"h "}b+="h "}else{b=""}if(c<10){c="0"+c}if(a<10){a="0"+a}return b+c+"m "+a+"s"}function countdownRestart(b){var c=$("#countdown-display").countdown("destroy");c.countdown({since:-(b),compact:true,format:"MS"});var a=$("#countdown-display-ss").countdown("destroy");a.countdown({since:-(b),compact:true,format:"MS"})}function reset_vol_changed_local(){GUI.vol_changed_local=0}function setvol(a){GUI.volume=a;$("#volumemute").removeClass("btn-primary");sendCmd("setvol "+a);if(GUI.vol_changed_local===0){setInterval(reset_vol_changed_local,5000);GUI.vol_changed_local=1}}function volumeStepCalc(c){var b=0;var a=c;GUI.volume=parseInt($("#volume").val());var e=function d(f){b++;if(c==="up"){GUI.stepVolumeDelta=parseInt(GUI.volume)+b}else{if(c==="dn"){GUI.stepVolumeDelta=parseInt(GUI.volume)-b}}$("#volume").val(GUI.stepVolumeDelta).trigger("change")};e();GUI.stepVolumeInt=window.setInterval(function(){e()},200)}function volumeStepSet(){window.clearInterval(GUI.stepVolumeInt);setvol(GUI.stepVolumeDelta)}function customScroll(h,a,g){if(typeof(g)==="undefined"){g=500}var f=49;var c=parseInt($(window).height()/2);var b=$(window).scrollTop();var e=0;var d=0;if(h==="db"){e=parseInt((a)*f-c);d=e}else{if(h==="pl"){e=parseInt((a+2)*f-c);d=Math.abs(e-b);d=(e>b?"+":"-")+"="+d+"px";$("#playlist-entries").find("li").eq(a).addClass("active")}}$.scrollTo((e>0?d:0),g)}function randomScrollPL(){var b=$(".playlist li").size();var a=1+Math.floor(Math.random()*b);customScroll("pl",a)}function randomScrollDB(){var b=$(".database li").size();var a=1+Math.floor(Math.random()*b);customScroll("db",a)}function toggleLoader(a){if(a==="close"){$("#loader").addClass("hide")}else{if($("#section-dev").length){$("#loader").addClass("hide");new PNotify({title:"Warning",text:"The loading layer (spinning arrows) points to a socket error",icon:"fa fa-exclamation-circle"})}else{$("#loader").removeClass("hide")}}}function customNotify(a){if(a.custom==="kernelswitch"){if(GUI.noticeUI.kernelswitch!==undefined){GUI.noticeUI.kernelswitch.remove()}GUI.noticeUI.kernelswitch=new PNotify({title:("title" in a)?a.title:"[missing title]",text:("text" in a)?a.text:"[missing text]",icon:"fa fa-refresh",hide:false,confirm:{confirm:true,buttons:[{text:a.btntext,addClass:"btn-default btn-block  uppercase",click:function(){$.post("/settings/",{syscmd:"reboot"});toggleLoader()}},{text:"Cancel",addClass:"hide"}]},buttons:{closer:false,sticker:false}})}}function renderMSG(c){var b=c[0];if("custom" in b&&b.custom!==null){customNotify(b);return}var a={title:("title" in b)?b.title:"[missing title]",text:("text" in b)?b.text:"[missing text]",icon:(b.icon===undefined)?"fa fa-check":b.icon,opacity:(b.opacity===undefined)?0.9:b.opacity,hide:(b.hide===undefined&&b.permanotice===undefined),buttons:{closer:(b.permanotice===undefined),sticker:(b.permanotice===undefined)},delay:(b.delay===undefined)?8000:b.delay,mouse_reset:false};if("permanotice" in b){if(GUI.noticeUI[b.permanotice]===undefined){GUI.noticeUI[b.permanotice]=new PNotify(a)}else{if("permaremove" in b){GUI.noticeUI[b.permanotice].remove();GUI.noticeUI[b.permanotice]=undefined}else{GUI.noticeUI[b.permanotice].open()}}}else{new PNotify(a)}}function sortOrder(b){var a=$("#"+b).index();b=parseInt(b.replace("pl-",""));sendCmd("moveid "+b+" "+a)}function loadingSpinner(b,a){if(a==="hide"){if(b==="db"){$("#spinner-db").addClass("hide")}if(b==="pl"){$("#spinner-pl").addClass("hide")}}else{if(b==="db"){$("#spinner-db").removeClass("hide")}if(b==="pl"){$("#spinner-pl").removeClass("hide")}}}function chkKey(a){return(a!==undefined&&a!=="")}function getPlaylist(b){data=b[0];if(data.length>4){$(".playlist").addClass("hide");$("#playlist-entries").removeClass("hide");getPlaylistPlain(data);var a=parseInt(GUI.json.song);if($("#panel-dx").hasClass("active")&&GUI.currentsong!==GUI.json.currentsong){customScroll("pl",a,200)}}else{$(".playlist").addClass("hide");$("#playlist-warning").removeClass("hide");$("#pl-filter-results").addClass("hide").html("");$("#pl-count").removeClass("hide").html("0 entries")}loadingSpinner("pl","hide")}function renderPlaylists(e){var d="",g="";var c,b,a=e.split("\n"),f=[];for(c=0;(b=a[c]);c+=1){f=b.split(": ");if("playlist"===f[0]){g=f[1];d+='<li class="pl-folder" data-path="'+g+'"><i class="fa fa-bars pl-action" data-target="#context-menu-playlist" data-toggle="context" title="Actions"></i><span><i class="fa fa-list-ol"></i>'+g+"</span></li>";g=""}}document.getElementById("playlist-entries").innerHTML="";$(".playlist").addClass("hide");$("#pl-manage").addClass("hide");$("#pl-count").addClass("hide");$("#pl-filter-results").removeClass("hide").addClass("back-to-queue").html('<i class="fa fa-arrow-left sx"></i> to queue');$("#pl-currentpath").removeClass("hide");$("#pl-editor").removeClass("hide");document.getElementById("pl-editor").innerHTML=d;loadingSpinner("pl","hide")}function getDB(i){var b=i.cmd||"browse",h=i.path||"",a=i.browsemode||"file",f=i.uplevel||"",c=i.plugin||"",g=i.querytype||"",e=i.args||"";loadingSpinner("db");GUI.browsemode=a;if(c!==""){if(c==="Spotify"){$.post("/db/?cmd=spotify",{plid:e},function(j){populateDB({data:j,path:h,plugin:c,querytype:g,uplevel:f,args:e})},"json")}else{if(c==="Dirble"){if(g==="childs"){$.post("/db/?cmd=dirble",{querytype:"childs",args:e},function(j){populateDB({data:j,path:h,plugin:c,querytype:"childs",uplevel:f})},"json");$.post("/db/?cmd=dirble",{querytype:"childs-stations",args:e},function(j){populateDB({data:j,path:h,plugin:c,querytype:"childs-stations",uplevel:f})},"json")}else{$.post("/db/?cmd=dirble",{querytype:(g==="")?"categories":g,args:e},function(j){populateDB({data:j,path:h,plugin:c,querytype:g,uplevel:f})},"json")}}else{if(c==="Jamendo"){$.post("/db/?cmd=jamendo",{querytype:(g==="")?"radio":g,args:e},function(j){populateDB({data:j.results,path:h,plugin:c,querytype:g})},"json")}}}}else{if(b==="search"){var d=$("#db-search-keyword").val();if(h.match(/Dirble/)){$.post("/db/?cmd=dirble",{querytype:"search",args:d},function(j){populateDB({data:j,path:h,plugin:"Dirble",querytype:"search",uplevel:f})},"json")}else{$.post("/db/?querytype="+GUI.browsemode+"&cmd=search",{query:d},function(j){populateDB({data:j,path:h,uplevel:f,keyword:d})},"json")}}else{if(b==="browse"){$.post("/db/?cmd=browse",{path:h,browsemode:GUI.browsemode},function(j){populateDB({data:j,path:h,uplevel:f})},"json")}else{loadingSpinner("db","hide");$.post("/db/?cmd="+b,{path:h,querytype:g},function(j){},"json")}}}}function libraryHome(a){GUI.libraryhome=a[0];if(GUI.libraryhome.clientUUID===GUI.clientUUID&&GUI.plugin!=="Dirble"&&GUI.currentpath!=="Webradio"){renderLibraryHome()}if(GUI.currentpath==="Webradio"){getDB({path:"Webradio",uplevel:0})}if(GUI.forceGUIupdate===true){GUI.forceGUIupdate=false;renderLibraryHome()}}function listWLANs(f){var b=0,d="",a="",c="",e=f[0];$.each(e,function(g){d+='<p><a href="/network/wlan/'+e[g].nic+"/"+e[g].ESSID+'" class="btn btn-lg btn-default btn-block" title="See network properties">';if(e[g].connected!==0){d+='<i class="fa fa-check green sx"></i>'}if(e[g].storedprofile===1&&e[g].encryption==="on"){d+='<i class="fa fa-lock sx"></i>'}else{if(e[g].encryption==="on"){d+='<i class="fa fa-rss fa-wifi"></i><i class="fa fa-lock sx"></i>'}else{if(e[g].storedprofile!==1){d+='<i class="fa fa-rss fa-wifi sx"></i>'}}}d+="<strong>"+e[g].ESSID+"</strong></a></p>";if(e[g].origin==="scan"){a+=d}if(e[g].storedprofile===1){c+=d}d=""});if(a===""){a='<p><a class="btn btn-lg btn-default btn-block" href="#"><i class="fa fa-cog fa-spin sx"></i>scanning for networks...</a></p>'}document.getElementById("wifiNetworks").innerHTML=a;document.getElementById("wifiStored").innerHTML=c;$.ajax({url:"/command/?cmd=wifiscan",cache:false})}function nicsDetails(d){var b=0,c="",a=d[0];$.each(a,function(e){if(e===$("#nic-details").data("name")){c+="<tr><th>Name:</th><td><strong>"+e+"<strong></td></tr>";c+="<tr><th>Type:</th><td>wireless</td></tr>";if(a[e].currentssid===null){c+='<tr><th>Status:</th><td><i class="fa fa-times red sx"></i>no network connected</td></tr>'}else{c+='<tr><th>Status:</th><td><i class="fa fa-check green sx"></i>connected</td></tr>';c+="<tr><th>Associated SSID:</th><td><strong>"+a[e].currentssid+"</strong></td></tr>"}c+="<tr><th>Assigned IP:</th><td>"+((a[e].ip!==null)?("<strong>"+a[e].ip+"</strong>"):"none")+"</td></tr>";c+="<tr><th>Speed:</th><td>"+((a[e].speed!==null)?a[e].speed:"unknown")+"</td></tr>";if(a[e].currentssid!==null){c+="<tr><th>Netmask:</th><td>"+a[e].netmask+"</td></tr>";c+="<tr><th>Gateway:</th><td>"+a[e].gw+"</td></tr>";c+="<tr><th>DNS1:</th><td>"+a[e].dns1+"</td></tr>";c+="<tr><th>DNS2:</th><td>"+a[e].dns2+"</td></tr>"}}});$("#nic-details tbody").html(c)}function playbackChannel(){var a=new PushStream({host:window.location.hostname,port:window.location.port,modes:GUI.mode,reconnectOnChannelUnavailableInterval:5000});a.onmessage=renderUI;a.onstatuschange=function(b){if(b===2){$("#loader").addClass("hide");sendCmd("renderui")}else{if(b===0){toggleLoader()}}};a.addChannel("playback");a.connect()}function queueChannel(){var a=new PushStream({host:window.location.hostname,port:window.location.port,modes:GUI.mode});a.onmessage=getPlaylist;a.addChannel("queue");a.connect()}function libraryChannel(){var a=new PushStream({host:window.location.hostname,port:window.location.port,modes:GUI.mode});a.onmessage=libraryHome;a.addChannel("library");a.connect()}function notifyChannel(){var a=new PushStream({host:window.location.hostname,port:window.location.port,modes:GUI.mode});a.onmessage=renderMSG;a.addChannel("notify");a.connect()}function wlansChannel(){var a=new PushStream({host:window.location.hostname,port:window.location.port,modes:GUI.mode});a.onmessage=listWLANs;a.addChannel("wlans");a.connect();$.ajax({url:"/command/?cmd=wifiscan",cache:false})}function nicsChannel(){var a=new PushStream({host:window.location.hostname,port:window.location.port,modes:GUI.mode});a.onmessage=nicsDetails;a.addChannel("nics");a.connect()}function overlayTrigger(d){var c=$(d),e=$(d+"-open"),b=$(d+"-close");transEndEventNames={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd",msTransition:"MSTransitionEnd",transition:"transitionend"};function a(){if(c.hasClass("open")){c.removeClass("open");c.addClass("closed");var i=function(j){if(support.transitions){if(j.propertyName!=="visibility"){return}this.removeEventListener(transEndEventName,i)}c.removeClass("closed")}}else{if(c.hasClass("closed")){c.addClass("open");if(d==="#overlay-social"){var h="https://twitter.com/home?status=Listening+to+"+GUI.json.currentsong.replace(/\s+/g,"+")+"+by+"+GUI.json.currentartist.replace(/\s+/g,"+")+"+on+%40RuneAudio+http%3A%2F%2Fwww.runeaudio.com%2F+%23nowplaying";var g="https://www.facebook.com/sharer.php?u=http%3A%2F%2Fwww.runeaudio.com%2F&display=popup";var f="https://plus.google.com/share?url=http%3A%2F%2Fwww.runeaudio.com%2F";$("#urlTwitter").attr("href",h);$("#urlFacebook").attr("href",g);$("#urlGooglePlus").attr("href",f)}}}}e.click(function(){a()});b.click(function(){a()})}function getHiddenProp(){var b=["webkit","moz","ms","o"];if("hidden" in document){return"hidden"}for(var a=0;a<b.length;a++){if((b[a]+"Hidden") in document){return b[a]+"Hidden"}}return null}function isHidden(){var a=getHiddenProp();if(!a){return false}return document[a]}function visChange(){if(isHidden()){GUI.visibility="hidden"}else{GUI.visibility="visible"}}if($("#section-index").length){jQuery(document).ready(function(f){GUI.mode=checkWebSocket();playbackChannel();libraryChannel();PNotify.prototype.options.styling="fontawesome";PNotify.prototype.options.stack.dir1="up";PNotify.prototype.options.stack.dir2="left";PNotify.prototype.options.stack.firstpos1=90;PNotify.prototype.options.stack.firstpos2=50;PNotify.prototype.options.stack.spacing1=10;PNotify.prototype.options.stack.spacing2=10;notifyChannel();var e=getHiddenProp();if(e){var a=e.replace(/[H|h]idden/,"")+"visibilitychange";document.addEventListener(a,visChange)}var g=f("#playlist-entries");g.on("click","li",function(i){var h="";var j=f("li","#playlist-entries").index(this);h="play "+j;sendCmd(h);f("li.active","#playlist-entries").removeClass("active");f(this).addClass("active")});var d=document.getElementById("playlist-entries");new Sortable(d,{ghostClass:"sortable-ghost",onUpdate:function(h){sortOrder(h.item.getAttribute("id"))}});var b=f("#database-entries");b.on("click","li",function(m){var l="",k="";var j=f(this);f("li.active","#database-entries").removeClass("active");j.addClass("active");if(j.hasClass("db-folder")){l=j.data("path");if(j.hasClass("db-album")){if(l!==""){getDB({path:l,uplevel:0,browsemode:"album"})}else{l=GUI.currentDBpath[GUI.currentDBpos[10]-1];getDB({path:l,uplevel:0,browsemode:"albumfilter"})}}else{if(j.hasClass("db-artist")){getDB({path:l,uplevel:0,browsemode:"artist"})}else{if(j.hasClass("db-composer")){getDB({path:l,uplevel:0,browsemode:"composer"})}else{if(j.hasClass("db-genre")){getDB({path:l,uplevel:0,browsemode:"genre"})}else{if(j.hasClass("db-spotify")){l=GUI.currentpath+"/"+j.find("span").text();getDB({path:l,plugin:"Spotify",args:j.data("path").toString(),querytype:"tracks"});GUI.plugin="Spotify"}else{if(j.hasClass("db-dirble")){l=GUI.currentpath+"/"+j.find("span").text();var h=(j.hasClass("db-dirble-child"))?"stations":"childs";getDB({path:l,plugin:"Dirble",querytype:h,args:j.data("path")});GUI.plugin="Dirble"}else{if(j.hasClass("db-jamendo")){}else{k=j.data("browsemode");getDB({path:l,uplevel:0,browsemode:k})}}}}}}}var i=j.attr("id");i=i.replace("db-","");GUI.currentDBpos[GUI.currentDBpos[10]]=i;GUI.currentDBpath[GUI.currentDBpos[10]]=l;++GUI.currentDBpos[10]}});b.on("dblclick","li",function(j){var h=f(this);if(!f(j.target).hasClass("db-action")){f("li.active","#database-entries").removeClass("active");h.addClass("active");var i=h.data("path");if(h.hasClass("db-spotify")){i=h.attr("data-plid")+"-"+h.attr("data-path");getDB({cmd:"spaddplay",path:i,querytype:"spotify-track"})}else{i=(h.hasClass("db-dirble"))?i.split(" | ")[1]:i;getDB({cmd:"addplay",path:i})}}});f("a",".context-menu").click(function(){var h=f(this).data("cmd");var i=f(this).data("type");var j=GUI.DBentry[0];GUI.DBentry[0]="";switch(h){case"pl-add":sendCmd('load "'+j+'"');break;case"pl-replace":sendCmd("clear");sendCmd('load "'+j+'"');break;case"pl-addreplaceplay":sendCmd("clear");sendCmd('load "'+j+'"');sendCmd("play");break;case"pl-ashuffle":f.post("/db/?cmd=pl-ashuffle",{playlist:j});f("#random").attr("data-cmd","pl-ashuffle-stop");f("#random").attr("title","Stop randomly adding songs");f("#random").addClass("btn-primary");break;case"wradd":j=j.split(" | ")[1];getDB({cmd:"add",path:j});break;case"wraddplay":j=j.split(" | ")[1];getDB({cmd:"addplay",path:j});break;case"wraddreplaceplay":j=j.split(" | ")[1];getDB({cmd:"addreplaceplay",path:j});break;default:getDB({cmd:h,path:j,browsemode:GUI.browsemode,querytype:i});break}});var c=document.location.toString();if(c.match("#")){f('#menu-bottom a[href="/#'+c.split("#")[1]+'"]').tab("show")}if(f(".ttip").length){f(".ttip").tooltip()}FastClick.attach(document.body);overlayTrigger("#overlay-social");overlayTrigger("#overlay-playsource");f("#playsource-spotify").click(function(){if(f(this).hasClass("inactive")){if(GUI.libraryhome.Spotify==="1"){GUI.forceGUIupdate=true;f.ajax({url:"/command/?switchplayer=Spotify",cache:false});f("#overlay-playsource-close").trigger("click")}else{new PNotify({title:"Spotify not enabled",text:"Enable and configure it under the Settings screen",icon:"fa fa-exclamation-circle"})}}});if(document.location.hostname=="localhost"){f(".osk-trigger").onScreenKeyboard({draggable:true})}})}else{jQuery(document).ready(function(d){GUI.mode=checkWebSocket();playbackChannel();PNotify.prototype.options.styling="fontawesome";PNotify.prototype.options.stack.dir1="up";PNotify.prototype.options.stack.dir2="left";PNotify.prototype.options.stack.firstpos1=90;PNotify.prototype.options.stack.firstpos2=50;PNotify.prototype.options.stack.spacing1=10;PNotify.prototype.options.stack.spacing2=10;notifyChannel();d(".selectpicker").selectpicker();if(d("#section-sources").length){if(d("#mount-type").val()==="nfs"){d("#mount-cifs").addClass("disabled").children(".disabler").removeClass("hide")}d("#mount-type").change(function(){if(d(this).val()==="cifs"||d(this).val()==="osx"){d("#mount-cifs").removeClass("disabled").children(".disabler").addClass("hide")}else{d("#mount-cifs").addClass("disabled").children(".disabler").removeClass("hide")}});d("#nas-guest").change(function(){if(d(this).prop("checked")){d("#mount-auth").addClass("disabled").children(".disabler").removeClass("hide")}else{d("#mount-auth").removeClass("disabled").children(".disabler").addClass("hide")}});d("#nas-advanced").change(function(){if(d(this).prop("checked")){d("#mount-advanced-config").removeClass("hide")}else{d("#mount-advanced-config").addClass("hide")}});d("#show-mount-advanced-config").click(function(f){f.preventDefault();if(d(this).hasClass("active")){d("#mount-advanced-config").toggleClass("hide");d(this).removeClass("active");d(this).find("i").removeClass("fa fa-minus-circle").addClass("fa fa-plus-circle");d(this).find("span").html("show advanced options")}else{d("#mount-advanced-config").toggleClass("hide");d(this).addClass("active");d(this).find("i").removeClass("fa fa-plus-circle").addClass("fa fa-minus-circle");d(this).find("span").html("hide advanced options")}});d("#usb-mount-list a").click(function(){var e=d(this).data("mount");d("#usb-umount-name").html(e);d("#usb-umount").val(e)})}if(d("#section-settings").length){d("#airplay").change(function(){if(d(this).prop("checked")){d("#airplayName").removeClass("hide");d("#airplayBox").addClass("boxed-group")}else{d("#airplayName").addClass("hide");d("#airplayBox").removeClass("boxed-group")}});d("#scrobbling-lastfm").change(function(){if(d(this).prop("checked")){d("#lastfmAuth").removeClass("hide");d("#lastfmBox").addClass("boxed-group")}else{d("#lastfmAuth").addClass("hide");d("#lastfmBox").removeClass("boxed-group")}});d("#proxy").change(function(){if(d(this).prop("checked")){d("#proxyAuth").removeClass("hide");d("#proxyBox").addClass("boxed-group")}else{d("#proxyAuth").addClass("hide");d("#proxyBox").removeClass("boxed-group")}});d("#dlna").change(function(){if(d(this).prop("checked")){d("#dlnaName").removeClass("hide");d("#dlnaBox").addClass("boxed-group")}else{d("#dlnaName").addClass("hide");d("#dlnaBox").removeClass("boxed-group")}});d("#spotify").change(function(){if(d(this).prop("checked")){d("#spotifyAuth").removeClass("hide");d("#spotifyBox").addClass("boxed-group")}else{d("#spotifyAuth").addClass("hide");d("#spotifyBox").removeClass("boxed-group")}});d(".btn-file :file").on("fileselect",function(g,h,f){var e=d(this).parents(".input-group").find(":text");if(e.length){e.val(f)}else{if(f){console.log("Selected file: ",f);if(f.indexOf("backup_")>-1&&f.indexOf(".tar.gz")>-1){d("#backup-file").html(' <i class="fa fa-check dx green"></i> '+f+"");d("#btn-backup-upload").prop("disabled",false)}else{d("#backup-file").html(' <i class="fa fa-times dx red"></i> not a valid backup file');d("#btn-backup-upload").prop("disabled",true)}}}})}if(d("#section-network").length){var b=d("#network-manual-config");if(d("#dhcp").val()==="0"){b.removeClass("hide")}d("#dhcp").change(function(){if(d(this).val()==="0"){b.removeClass("hide")}else{b.addClass("hide")}});var c=d("#wifi-security-key");if(d("#wifi-security").val()!=="open"){c.removeClass("hide")}d("#wifi-security").change(function(){if(d(this).val()!=="open"){c.removeClass("hide")}else{c.addClass("hide")}});if(d("#wifiNetworks").length){wlansChannel();nicsChannel()}d("#wifiProfiles").change(function(){if(d(this).prop("checked")){d("#wifiProfilesBox").addClass("hide")}else{d("#wifiProfilesBox").removeClass("hide")}})}if(d("#section-accesspoint").length){d("#accesspoint").change(function(){if(d(this).prop("checked")){d("#accesspointSettings").removeClass("hide");d("#accesspointBox").addClass("boxed-group")}else{d("#accesspointSettings").addClass("hide");d("#accesspointBox").removeClass("boxed-group")}});d("#ip-address").change(function(){var e=d("#ip-address").val().split(".");e[3]++;d("#dhcp-range").val(e.join(".")+","+e[0]+"."+e[1]+"."+e[2]+".254,24h");e[3]=255;d("#broadcast").val(e.join("."));d("#dhcp-option-dns").val(d("#ip-address").val());d("#dhcp-option-router").val(d("#ip-address").val())})}if(d("#section-mpd").length){d("#audio-output-interface").change(function(){renderMSG([{title:"Switching audio output",text:"Please wait for the config update...",icon:"fa fa-cog fa-spin",delay:5000}]);var e=d(this).val();d.ajax({type:"POST",url:"/mpd/",data:{ao:e},cache:false})});d(".manual-edit-confirm").find(".btn-primary").click(function(){d("#mpdconf_editor").removeClass("hide");d("#manual-edit-warning").addClass("hide")})}if(d("#section-debug").length){ZeroClipboard.config({swfPath:"/assets/js/vendor/ZeroClipboard.swf"});var a=new ZeroClipboard(document.getElementById("copy-to-clipboard"));a.on("ready",function(e){a.on("aftercopy",function(f){new PNotify({title:"Copied to clipboard",text:"The debug output was copied successfully in your clipboard.",icon:"fa fa-check"})})})}if(document.location.hostname=="localhost"){d(".osk-trigger").onScreenKeyboard({draggable:true})}});$(document).on("change",".btn-file :file",function(){var a=$(this),c=a.get(0).files?a.get(0).files.length:1,b=a.val().replace(/\\/g,"/").replace(/.*\//,"");a.trigger("fileselect",[c,b])})};