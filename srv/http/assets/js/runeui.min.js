var GUI={DBentry:["","",""],DBupdate:0,activePlayer:"",browsemode:"file",checkvol:0,currentDBpos:[0,0,0,0,0,0,0,0,0,0,0],currentDBpath:["","","","","","","","","","",""],currentalbum:null,currentknob:null,currentpath:"",currentsong:null,json:0,libraryhome:"",forceGUIupdate:false,maxvol:100,minvol:0,mode:"websocket",noticeUI:{},playlist:null,plugin:"",state:"",old_state:"none",stepVolumeDelta:0,stepVolumeInt:0,stream:"",visibility:"visible",vol_changed_local:0,volume:null,clientUUID:null};function generateUUID(){var b=new Date().getTime();var a="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var d=(b+Math.random()*16)%16|0;b=Math.floor(b/16);return(e=="x"?d:(d&3|8)).toString(16)});return a}function sendCmd(a){$.ajax({type:"GET",url:"/command/?cmd="+a+"&clientUUID="+GUI.clientUUID,cache:false})}function checkWebSocket(){if(window.WebSocket){return"websocket"}else{return"longpolling"}}function checkWorkers(){if((window.Worker&&window.Blob)||(Modernizr.webworkers&&Modernizr.blobconstructor)){return true}else{return false}}function parsePath(c){var a=c&&c.length?c.lastIndexOf("/"):0;var b="";if(a&&a!==-1){b=c.slice(0,a)}return b}var idleTime=0;var viewScreenSaver=0;var widthScreenSaver=0;var isLocalHost=0;var SStime=-1;$(document).ready(function(){GUI.clientUUID=generateUUID();if($("#section-index").length){if(location.hostname==="localhost"||location.hostname==="127.0.0.1"){isLocalHost=1;SStime=localSStime}else{isLocalHost=0;SStime=remoteSStime}if(SStime>=0){var a=setInterval(timerIncrement,1000)}$(this).on("mousemove click keypress",function(b){idleTime=0;if(viewScreenSaver){$(".tab-content").show("slow");$(".screen-saver-content").hide("slow");$("#menu-bottom").show("slow");$("#menu-top").show("slow");viewScreenSaver=0}})}});function timerIncrement(){if($("#section-index").length&&GUI.state==="play"){idleTime=idleTime+1}else{idleTime=0}if(idleTime>SStime){$(".tab-content").hide("slow");$(".screen-saver-content").show("slow");$("#menu-bottom").hide("slow");$("#menu-top").hide("slow");viewScreenSaver=1}}function refreshTimer(d,a,c){var e=$("#countdown-display");e.countdown("destroy");e.countdown({since:((c!=="stop"||c!==undefined)?-(d):0),compact:true,format:"MS"});if(c!=="play"){e.countdown("pause")}var b=$("#countdown-display-ss");b.countdown("destroy");b.countdown({since:((c!=="stop"||c!==undefined)?-(d):0),compact:true,format:"MS"});if(c!=="play"){b.countdown("pause")}}function refreshKnob(){window.clearInterval(GUI.currentKnob);var a=parseInt(GUI.json.song_percent)*10;var d=parseInt(GUI.json.time);var b=parseInt(1000/d);var c=$("#time");c.val(a,false).trigger("update");if(GUI.state==="play"){GUI.currentKnob=setInterval(function(){a=a+((GUI.visibility!=="visible")?b:1);c.val(a,false).trigger("update")},d)}}function timeConvert(d){var b=Math.floor(d/60);d-=b*60;var c=(b<10)?("0"+b):b;var a=(d<10)?("0"+d):d;return c+":"+a}function timeConvert2(a){var b=Math.floor(a/3600);var c=Math.floor((a-(b*3600))/60);a=Math.floor(a-(b*3600)-(c*60));if(b>0){if(b<10){b="0"+b}b+=":"}else{b=""}if(c<10){c="0"+c}if(a<10){a="0"+a}return b+c+":"+a}function timeConvert3(a){var b=Math.floor(a/3600);var c=Math.floor((a-(b*3600))/60);a=Math.floor(a-(b*3600)-(c*60));if(b>0){if(b<10){b="0"+b+"h "}b+="h "}else{b=""}if(c<10){c="0"+c}if(a<10){a="0"+a}return b+c+"m "+a+"s"}function countdownRestart(b){var c=$("#countdown-display").countdown("destroy");c.countdown({since:-(b),compact:true,format:"MS"});var a=$("#countdown-display-ss").countdown("destroy");a.countdown({since:-(b),compact:true,format:"MS"})}function reset_vol_changed_local(){GUI.vol_changed_local=0}function setvol(a){GUI.volume=a;$("#volumemute").removeClass("btn-primary");sendCmd("setvol "+a);if(GUI.vol_changed_local===0){setInterval(reset_vol_changed_local,5000);GUI.vol_changed_local=1}}function volumeStepCalc(c){var b=0;var a=c;GUI.volume=parseInt($("#volume").val());var e=function d(f){b++;if(c==="up"){GUI.stepVolumeDelta=parseInt(GUI.volume)+b}else{if(c==="dn"){GUI.stepVolumeDelta=parseInt(GUI.volume)-b}}$("#volume").val(GUI.stepVolumeDelta).trigger("change")};e();GUI.stepVolumeInt=window.setInterval(function(){e()},200)}function volumeStepSet(){window.clearInterval(GUI.stepVolumeInt);setvol(GUI.stepVolumeDelta)}function customScroll(h,a,g){if(typeof(g)==="undefined"){g=500}var f=49;var c=parseInt($(window).height()/2);var b=$(window).scrollTop();var e=0;var d=0;if(h==="db"){e=parseInt((a)*f-c);d=e}else{if(h==="pl"){e=parseInt((a+2)*f-c);d=Math.abs(e-b);d=(e>b?"+":"-")+"="+d+"px";$("#playlist-entries").find("li").eq(a).addClass("active")}}$.scrollTo((e>0?d:0),g)}function randomScrollPL(){var b=$(".playlist li").size();var a=1+Math.floor(Math.random()*b);customScroll("pl",a)}function randomScrollDB(){var b=$(".database li").size();var a=1+Math.floor(Math.random()*b);customScroll("db",a)}function toggleLoader(a){if(a==="close"){$("#loader").addClass("hide")}else{if($("#section-dev").length){$("#loader").addClass("hide");new PNotify({title:"Warning",text:"The loading layer (spinning arrows) points to a socket error",icon:"fa fa-exclamation-circle"})}else{$("#loader").removeClass("hide")}}}function customNotify(a){if(a.custom==="kernelswitch"){if(GUI.noticeUI.kernelswitch!==undefined){GUI.noticeUI.kernelswitch.remove()}GUI.noticeUI.kernelswitch=new PNotify({title:("title" in a)?a.title:"[missing title]",text:("text" in a)?a.text:"[missing text]",icon:"fa fa-refresh",hide:false,confirm:{confirm:true,buttons:[{text:a.btntext,addClass:"btn-default btn-block  uppercase",click:function(){$.post("/settings/",{syscmd:"reboot"});toggleLoader()}},{text:"Cancel",addClass:"hide"}]},buttons:{closer:false,sticker:false}})}}function renderMSG(c){var b=c[0];if("custom" in b&&b.custom!==null){customNotify(b);return}var a={title:("title" in b)?b.title:"[missing title]",text:("text" in b)?b.text:"[missing text]",icon:(b.icon===undefined)?"fa fa-check":b.icon,opacity:(b.opacity===undefined)?0.9:b.opacity,hide:(b.hide===undefined&&b.permanotice===undefined),buttons:{closer:(b.permanotice===undefined),sticker:(b.permanotice===undefined)},delay:(b.delay===undefined)?8000:b.delay,mouse_reset:false};if("permanotice" in b){if(GUI.noticeUI[b.permanotice]===undefined){GUI.noticeUI[b.permanotice]=new PNotify(a)}else{if("permaremove" in b){GUI.noticeUI[b.permanotice].remove();GUI.noticeUI[b.permanotice]=undefined}else{GUI.noticeUI[b.permanotice].open()}}}else{new PNotify(a)}}function sortOrder(b){var a=$("#"+b).index();b=parseInt(b.replace("pl-",""));sendCmd("moveid "+b+" "+a)}function loadingSpinner(b,a){if(a==="hide"){if(b==="db"){$("#spinner-db").addClass("hide")}if(b==="pl"){$("#spinner-pl").addClass("hide")}}else{if(b==="db"){$("#spinner-db").removeClass("hide")}if(b==="pl"){$("#spinner-pl").removeClass("hide")}}}function setPlaybackSource(){var a=GUI.libraryhome.ActivePlayer;$("#overlay-playsource-open button").text(a);$("#overlay-playsource a").addClass("inactive");var b=a.toLowerCase();$("#playsource-"+b).removeClass("inactive");if(a==="Spotify"||a==="Airplay"){$("#volume").trigger("configure",{readOnly:true,fgColor:"#1A242F"}).css({color:"#1A242F"});$("#volume-knob").addClass("nomixer");$("#volume-knob button").prop("disabled",true);$("#single").addClass("disabled")}else{$("#volume").trigger("configure",{readOnly:false,fgColor:"#0095D8"}).css({color:"#0095D8"});$("#volume-knob").removeClass("nomixer");$("#volume-knob button").prop("disabled",false);$("#single").removeClass("disabled")}$("#playlist-entries").removeClass(function(c,d){return(d.match(/(^|\s)playlist-\S+/g)||[]).join(" ")}).addClass("playlist-"+b);$("#pl-manage").removeClass(function(c,d){return(d.match(/(^|\s)pl-manage-\S+/g)||[]).join(" ")}).addClass("pl-manage-"+b)}function chkKey(a){return(a!==undefined&&a!=="")}function getPlaylist(b){data=b[0];if(data.length>4){$(".playlist").addClass("hide");$("#playlist-entries").removeClass("hide");getPlaylistPlain(data);var a=parseInt(GUI.json.song);if($("#panel-dx").hasClass("active")&&GUI.currentsong!==GUI.json.currentsong){customScroll("pl",a,200)}}else{$(".playlist").addClass("hide");$("#playlist-warning").removeClass("hide");$("#pl-filter-results").addClass("hide").html("");$("#pl-count").removeClass("hide").html("0 entries")}loadingSpinner("pl","hide")}function renderPlaylists(e){var d="",g="";var c,b,a=e.split("\n"),f=[];for(c=0;(b=a[c]);c+=1){f=b.split(": ");if("playlist"===f[0]){g=f[1];d+='<li class="pl-folder" data-path="'+g+'"><i class="fa fa-bars pl-action" data-target="#context-menu-playlist" data-toggle="context" title="Actions"></i><span><i class="fa fa-list-ol"></i>'+g+"</span></li>";g=""}}document.getElementById("playlist-entries").innerHTML="";$(".playlist").addClass("hide");$("#pl-manage").addClass("hide");$("#pl-count").addClass("hide");$("#pl-filter-results").removeClass("hide").addClass("back-to-queue").html('<i class="fa fa-arrow-left sx"></i> to queue');$("#pl-currentpath").removeClass("hide");$("#pl-editor").removeClass("hide");document.getElementById("pl-editor").innerHTML=d;loadingSpinner("pl","hide")}function getPlaylists(){loadingSpinner("pl");$.ajax({url:"/command/?cmd=listplaylists",success:function(a){renderPlaylists(a)},cache:false})}function updatePlaylistDropdown(e){var d,b,a=e.split("\n"),f=[];var c="";for(d=0;(b=a[d]);d+=1){f=b.split(": ");if("playlist"===f[0]){c+='<option value="'+f[1]+'" />'}}document.getElementById("pl-list").innerHTML=c;loadingSpinner("pl","hide")}function getPlaylistsDropdown(){loadingSpinner("pl");$.ajax({url:"/command/?cmd=listplaylists",success:function(a){updatePlaylistDropdown(a)},cache:false})}function parseResponse(d){var h=d.inputArr||"",a=d.respType||"",f=d.i||0,e=d.inpath||"",c=d.querytype||"",g="";switch(a){case"playlist":break;case"db":if(GUI.browsemode==="file"){if(e===""&&h.file!==undefined){e=parsePath(h.file)}if(h.file!==undefined||e==="Webradio"){g='<li id="db-'+(f+1)+'" data-path="';if(h.Title!==undefined){g+=h.file;g+='"><i class="fa fa-bars db-action" title="Actions" data-toggle="context" data-target="#context-menu-file"></i><i class="fa fa-music db-icon"></i><span class="sn">';g+=h.Title+" <span>"+timeConvert(h.Time)+"</span></span>";g+=' <span class="bl">';g+=h.Artist;g+=" - ";g+=h.Album}else{if(e!=="Webradio"){g+=h.file;g+='"><i class="fa fa-bars db-action" title="Actions" data-toggle="context" data-target="#context-menu-file"></i><i class="fa fa-music db-icon"></i><span class="sn">';g+=h.file.replace(e+"/","")+" <span>"+timeConvert(h.Time)+"</span></span>";g+='<span class="bl">';g+=" path: ";g+=e}else{g+=h.playlist;g+='"><i class="fa fa-bars db-action" title="Actions" data-toggle="context" data-target="#context-menu-webradio"></i><i class="fa fa-webradio db-icon db-radio"></i>';g+='<span class="sn">'+h.playlist.replace(e+"/","").replace("."+h.fileext,"");g+='</span><span class="bl">webradio'}}g+="</span></li>"}else{if(h.playlist!==undefined){if(h.fileext==="cue"){g='<li id="db-'+(f+1)+'" data-path="';g+=h.playlist;g+='"><i class="fa fa-bars db-action" title="Actions" data-toggle="context" data-target="#context-menu-file"></i><i class="fa fa-file-text db-icon"></i><span class="sn">';g+=h.playlist.replace(e+"/","")+" <span>[CUE file]</span></span>";g+='<span class="bl">';g+=" path: ";g+=e;g+="</span></li>"}}else{g='<li id="db-'+(f+1)+'" class="db-folder" data-path="';g+=h.directory;if(e!==""){g+='"><i class="fa fa-bars db-action" title="Actions" data-toggle="context" data-target="#context-menu"></i><span><i class="fa fa-folder-open"></i>'}else{g+='"><i class="fa fa-bars db-action" title="Actions" data-toggle="context" data-target="#context-menu-root"></i><i class="fa fa-hdd-o icon-root"></i><span>'}g+=h.directory.replace(e+"/","");g+="</span></li>"}}}else{if(GUI.browsemode==="album"||GUI.browsemode==="albumfilter"){if(h.file!==undefined){g='<li id="db-'+(f+1)+'" data-path="';g+=h.file;g+='"><i class="fa fa-bars db-action" title="Actions" data-toggle="context" data-target="#context-menu-file"></i><i class="fa fa-music db-icon"></i><span class="sn">';g+=h.Title+" <span>"+timeConvert(h.Time)+"</span></span>";g+=' <span class="bl">';g+=h.Artist;g+=" - ";g+=h.Album;g+="</span></li>"}else{if(h.album!==""){g='<li id="db-'+(f+1)+'" class="db-folder db-album" data-path="';g+=h.album.replace(/\"/g,"&quot;");g+='"><i class="fa fa-bars db-action" title="Actions" data-toggle="context" data-target="#context-menu-album"></i><span><i class="fa fa-dot-circle-o"></i>';g+=h.album;g+="</span></li>"}}}else{if(GUI.browsemode==="artist"){if(h.album!==undefined){g='<li id="db-'+(f+1)+'" class="db-folder db-album" data-path="';g+=h.album;g+='"><i class="fa fa-bars db-action" title="Actions" data-toggle="context" data-target="#context-menu-album"></i><span><i class="fa fa-dot-circle-o"></i>';g+=(h.album!=="")?h.album:"Unknown album";g+="</span></li>"}else{if(h.artist!==""){g='<li id="db-'+(f+1)+'" class="db-folder db-artist" data-path="';g+=h.artist;g+='"><i class="fa fa-bars db-action" title="Actions" data-toggle="context" data-target="#context-menu-artist"></i><span><i class="fa fa-user"></i>';g+=h.artist;g+="</span></li>"}}}else{if(GUI.browsemode==="composer"){if(h.file!==undefined){g='<li id="db-'+(f+1)+'" data-path="';g+=h.file;g+='"><i class="fa fa-bars db-action" title="Actions" data-toggle="context" data-target="#context-menu-file"></i><i class="fa fa-music db-icon"></i><span class="sn">';g+=h.Title+" <span>"+timeConvert(h.Time)+"</span></span>";g+=' <span class="bl">';g+=h.Artist;g+=" - ";g+=h.Album;g+="</span></li>"}else{if(h.composer!==""){g='<li id="db-'+(f+1)+'" class="db-folder db-composer" data-path="';g+=h.composer;g+='"><i class="fa fa-bars db-action" title="Actions" data-toggle="context" data-target="#context-menu-composer"></i><span><i class="fa fa-user"></i>';g+=h.composer;g+="</span></li>"}}}else{if(GUI.browsemode==="genre"){if(h.artist!==undefined){g='<li id="db-'+(f+1)+'" class="db-folder db-artist" data-path="';g+=h.artist;g+='"><i class="fa fa-bars db-action" title="Actions" data-toggle="context" data-target="#context-menu-artist"></i><span><i class="fa fa-dot-circle-o"></i>';g+=(h.artist!=="")?h.artist:"Unknown artist";g+="</span></li>"}else{if(h.genre!==""){g='<li id="db-'+(f+1)+'" class="db-folder db-genre" data-path="';g+=h.genre;g+='"><i class="fa fa-bars db-action" title="Actions" data-toggle="context" data-target="#context-menu-genre"></i><span><i class="fa fa-tags"></i>';g+=h.genre;g+="</span></li>"}}}}}}}break;case"Spotify":if(c===""){g='<li id="db-'+(f+1)+'" class="db-spotify db-folder" data-path="';g+=h.index;g+='"><i class="fa fa-bars db-action" title="Actions" data-toggle="context" data-target="#context-menu-spotify-pl"></i><span><i class="fa fa-folder-open"></i>';g+=(h.name!=="")?h.name:"Favorites";g+=" (";g+=h.tracks;g+=")</span></li>"}else{if(c==="tracks"){g='<li id="db-'+(f+1)+'" class="db-spotify" data-path="';g+=h.index;g+='" data-plid="';g+=e;g+='" data-type="spotify-track"><i class="fa fa-bars db-action" title="Actions" data-toggle="context" data-target="#context-menu-spotify"></i><i class="fa fa-spotify db-icon"></i><span class="sn">';g+=h.title+" <span>"+timeConvert(h.duration/1000)+"</span></span>";g+=' <span class="bl">';g+=h.artist;g+=" - ";g+=h.album;g+="</span></li>"}}break;case"Dirble":if(c===""||c==="childs"){var b=(c==="childs")?" db-dirble-child":"";g='<li id="db-'+(f+1)+'" class="db-dirble db-folder'+b+'" data-path="';g+=h.id;g+='"><span><i class="fa fa-folder-open"></i>';g+=h.title;g+="</span></li>"}else{if(c==="search"||c==="stations"||c==="childs-stations"){if(h.streams.length===0){break}g='<li id="db-'+(f+1)+'" class="db-dirble db-radio" data-path="';g+=h.name+" | "+h.streams[0].stream;g+='"><i class="fa fa-bars db-action" title="Actions" data-toggle="context" data-target="#context-menu-dirble"></i><i class="fa fa-webradio db-icon"></i>';g+='<span class="sn">'+h.name+"<span>("+h.country+")</span></span>";g+='<span class="bl">';g+=h.website?h.website:"-no website-";g+="</span></li>"}}break;case"Jamendo":g='<li id="db-'+(f+1)+'" class="db-jamendo db-folder" data-path="';g+=h.stream;g+='"><img class="jamendo-cover" src="/tun/'+h.image+'" alt=""><i class="fa fa-bars db-action" title="Actions" data-toggle="context" data-target="#context-menu-file"></i>';g+=h.dispname+"</div></li>";break}return g}function populateDB(p){var c=p.data||"",o=p.path||"",k=p.uplevel||0,f=p.keyword||"",e=p.plugin||"",l=p.querytype||"",j=p.args||"",g="",b=0,n=[];console.log(JSON.stringify(c));if(e!==""){if(e==="Spotify"){$("#database-entries").removeClass("hide");$("#db-level-up").removeClass("hide");$("#home-blocks").addClass("hide");if(o){GUI.currentpath=o}document.getElementById("database-entries").innerHTML="";c=(l==="tracks")?c.tracks:c.playlists;c.sort(function(q,i){if(o==="Spotify"&&l===""){nameA=q.hasOwnProperty("name")?q.name.toLowerCase():"";nameB=i.hasOwnProperty("name")?i.name.toLowerCase():""}else{if(l==="tracks"){nameA=q.hasOwnProperty("title")?q.title.toLowerCase():"";nameB=i.hasOwnProperty("title")?i.title.toLowerCase():""}else{return 0}}if(nameA<nameB){return -1}if(nameA>nameB){return 1}return 0});for(b=0;(n=c[b]);b+=1){g+=parseResponse({inputArr:n,respType:"Spotify",i:b,querytype:l,inpath:j})}document.getElementById("database-entries").innerHTML=g}if(e==="Dirble"){$("#database-entries").removeClass("hide");$("#db-level-up").removeClass("hide");$("#home-blocks").addClass("hide");if(o){if(l==="search"){GUI.currentpath="Dirble"}else{GUI.currentpath=o}}if(l==="childs-stations"){g=document.getElementById("database-entries").innerHTML}else{document.getElementById("database-entries").innerHTML=""}c.sort(function(q,i){if(l==="childs"||l==="categories"){nameA=q.hasOwnProperty("title")?q.title.toLowerCase():"";nameB=i.hasOwnProperty("title")?i.title.toLowerCase():""}else{if(l==="childs-stations"||l==="stations"){nameA=q.hasOwnProperty("name")?q.name.toLowerCase():"";nameB=i.hasOwnProperty("name")?i.name.toLowerCase():""}else{return 0}}if(nameA<nameB){return -1}if(nameA>nameB){return 1}return 0});for(b=0;(n=c[b]);b+=1){g+=parseResponse({inputArr:n,respType:"Dirble",i:b,querytype:l})}document.getElementById("database-entries").innerHTML=g}if(e==="Jamendo"){$("#database-entries").removeClass("hide");$("#db-level-up").removeClass("hide");$("#home-blocks").addClass("hide");if(o){GUI.currentpath=o}document.getElementById("database-entries").innerHTML="";c.sort(function(q,i){if(o==="Jamendo"&&l===""){nameA=q.hasOwnProperty("dispname")?q.dispname.toLowerCase():"";nameB=i.hasOwnProperty("dispname")?i.dispname.toLowerCase():""}else{return 0}if(nameA<nameB){return -1}if(nameA>nameB){return 1}return 0});for(b=0;(n=c[b]);b+=1){g+=parseResponse({inputArr:n,respType:"Jamendo",i:b,querytype:l})}document.getElementById("database-entries").innerHTML=g}}else{if(o===""&&f===""){renderLibraryHome();return}else{$("#database-entries").removeClass("hide");$("#db-level-up").removeClass("hide");$("#home-blocks").addClass("hide");if(o){GUI.currentpath=o}document.getElementById("database-entries").innerHTML="";if(f!==""){var a=(c.length)?c.length:"0";var m=(c.length===1)?"":"s";$("#db-level-up").addClass("hide");$("#db-search-results").removeClass("hide").html('<i class="fa fa-times sx"></i><span class="visible-xs-inline">back</span><span class="hidden-xs">'+a+" result"+m+' for "<span class="keyword">'+f+'</span>"</span>')}c.sort(function(q,i){if(o==="Artists"||o==="AlbumArtists"||o==="Various Artists"){nameA=q.hasOwnProperty("artist")?q.artist.toLowerCase():"";nameB=i.hasOwnProperty("artist")?i.artist.toLowerCase():""}else{if(o==="Albums"){nameA=q.hasOwnProperty("album")?q.album.toLowerCase():"";nameB=i.hasOwnProperty("album")?i.album.toLowerCase():""}else{if(o==="Webradio"){nameA=q.hasOwnProperty("playlist")?q.playlist.toLowerCase():"";nameB=i.hasOwnProperty("playlist")?i.playlist.toLowerCase():""}else{if(o==="Genres"){nameA=q.hasOwnProperty("genre")?q.genre.toLowerCase():"";nameB=i.hasOwnProperty("genre")?i.genre.toLowerCase():""}else{return 0}}}}if(nameA<nameB){return -1}if(nameA>nameB){return 1}return 0});if(o==="Webradio"){g+='<li id="webradio-add" class="db-webradio-add"><i class="fa fa-plus-circle db-icon"></i><span class="sn"><em>add new</em></span><span class="bl">add a webradio to your library</span></li>'}for(b=0;(n=c[b]);b+=1){g+=parseResponse({inputArr:n,respType:"db",i:b,inpath:o})}document.getElementById("database-entries").innerHTML=g}}var h=$("span","#db-currentpath");if(GUI.browsemode==="album"){if(o==="Albums"){h.html(o)}else{h.html("Albums/"+o)}}else{if(GUI.browsemode==="artist"){if(o==="Artists"){h.html(o)}else{h.html("Artists/"+o)}}else{if(GUI.browsemode==="composer"){if(o==="Composer"){h.html(o)}else{h.html("Composer/"+o)}}else{if(GUI.browsemode==="genre"){if(o==="Genres"){h.html(o)}else{h.html("Genres/"+o)}}else{h.html(o)}}}}$("#db-homeSetup").addClass("hide");if(k){var d=GUI.currentDBpos[GUI.currentDBpos[10]];$("#db-"+d).addClass("active");customScroll("db",d,0)}else{customScroll("db",0,0)}if(l!="childs"){loadingSpinner("db","hide")}}function getDB(i){var b=i.cmd||"browse",h=i.path||"",a=i.browsemode||"file",f=i.uplevel||"",c=i.plugin||"",g=i.querytype||"",e=i.args||"";loadingSpinner("db");GUI.browsemode=a;if(c!==""){if(c==="Spotify"){$.post("/db/?cmd=spotify",{plid:e},function(j){populateDB({data:j,path:h,plugin:c,querytype:g,uplevel:f,args:e})},"json")}else{if(c==="Dirble"){if(g==="childs"){$.post("/db/?cmd=dirble",{querytype:"childs",args:e},function(j){populateDB({data:j,path:h,plugin:c,querytype:"childs",uplevel:f})},"json");$.post("/db/?cmd=dirble",{querytype:"childs-stations",args:e},function(j){populateDB({data:j,path:h,plugin:c,querytype:"childs-stations",uplevel:f})},"json")}else{$.post("/db/?cmd=dirble",{querytype:(g==="")?"categories":g,args:e},function(j){populateDB({data:j,path:h,plugin:c,querytype:g,uplevel:f})},"json")}}else{if(c==="Jamendo"){$.post("/db/?cmd=jamendo",{querytype:(g==="")?"radio":g,args:e},function(j){populateDB({data:j.results,path:h,plugin:c,querytype:g})},"json")}}}}else{if(b==="search"){var d=$("#db-search-keyword").val();if(h.match(/Dirble/)){$.post("/db/?cmd=dirble",{querytype:"search",args:d},function(j){populateDB({data:j,path:h,plugin:"Dirble",querytype:"search",uplevel:f})},"json")}else{$.post("/db/?querytype="+GUI.browsemode+"&cmd=search",{query:d},function(j){populateDB({data:j,path:h,uplevel:f,keyword:d})},"json")}}else{if(b==="browse"){$.post("/db/?cmd=browse",{path:h,browsemode:GUI.browsemode},function(j){populateDB({data:j,path:h,uplevel:f})},"json")}else{loadingSpinner("db","hide");$.post("/db/?cmd="+b,{path:h,querytype:g},function(j){},"json")}}}}function onreleaseKnob(b){if(GUI.state!=="stop"&&GUI.state!==""){if(GUI.stream!=="radio"){window.clearInterval(GUI.currentKnob);var a=Math.floor((b*parseInt(GUI.json.time))/1000);sendCmd("seek "+GUI.json.song+" "+a);$("#time").val(b);$("#countdown-display").countdown("destroy");$("#countdown-display-ss").countdown("destroy");$("#countdown-display").countdown({since:-a,compact:true,format:"MS"});$("#countdown-display-ss").countdown({since:-a,compact:true,format:"MS"})}else{$("#time").val(0).trigger("change")}}}function commandButton(c){var a=c.data("cmd");var e;if(a==="stop"){c.addClass("btn-primary");$("#play").removeClass("btn-primary");if($("#section-index").length){refreshTimer(0,0,"stop");window.clearInterval(GUI.currentKnob);$(".playlist").find("li").removeClass("active");$("#total").html("00:00");$("#total-ss").html("00:00")}}else{if(a==="play"){var d=GUI.state;if(d==="play"){e="pause";if($("#section-index").length){$("#countdown-display").countdown("pause");$("#countdown-display-ss").countdown("pause")}}else{if(d==="pause"){e="play";if($("#section-index").length){$("#countdown-display").countdown("resume");$("#countdown-display-ss").countdown("resume")}}else{if(d==="stop"){e="play";if($("#section-index").length){$("#countdown-display").countdown({since:0,compact:true,format:"MS"});$("#countdown-display-ss").countdown({since:0,compact:true,format:"MS"})}}}}window.clearInterval(GUI.currentKnob);sendCmd(e);return}else{if(a==="previous"||a==="next"){if($("#section-index").length){$("#countdown-display").countdown("pause");$("#countdown-display-ss").countdown("pause");window.clearInterval(GUI.currentKnob)}}else{if(c.hasClass("btn-volume")){var b;var f=parseInt($("#volume").val());if(a==="volumedn"&&parseInt(GUI.volume)>0){b=parseInt(GUI.volume)-1;GUI.volume=b;$("#volumemute").removeClass("btn-primary")}else{if(a==="volumeup"&&parseInt(GUI.volume)<100){b=parseInt(GUI.volume)+1;GUI.volume=b;$("#volumemute").removeClass("btn-primary")}else{if(a==="volumemute"){if(f!==0){GUI.volume=f;c.addClass("btn-primary");b=0}else{c.removeClass("btn-primary");b=GUI.volume}}}}if((b>=0)&&(b<=100)){sendCmd("setvol "+b);$("#volume").val(b,false).trigger("update")}return}}}}if(c.hasClass("btn-toggle")){e=a+(c.hasClass("btn-primary")?" 0":" 1");c.toggleClass("btn-primary")}else{e=a}sendCmd(e)}function libraryHome(a){GUI.libraryhome=a[0];if(GUI.libraryhome.clientUUID===GUI.clientUUID&&GUI.plugin!=="Dirble"&&GUI.currentpath!=="Webradio"){renderLibraryHome()}if(GUI.currentpath==="Webradio"){getDB({path:"Webradio",uplevel:0})}if(GUI.forceGUIupdate===true){GUI.forceGUIupdate=false;renderLibraryHome()}}function listWLANs(f){var b=0,d="",a="",c="",e=f[0];$.each(e,function(g){d+='<p><a href="/network/wlan/'+e[g].nic+"/"+e[g].ESSID+'" class="btn btn-lg btn-default btn-block" title="See network properties">';if(e[g].connected!==0){d+='<i class="fa fa-check green sx"></i>'}if(e[g].storedprofile===1&&e[g].encryption==="on"){d+='<i class="fa fa-lock sx"></i>'}else{if(e[g].encryption==="on"){d+='<i class="fa fa-rss fa-wifi"></i><i class="fa fa-lock sx"></i>'}else{if(e[g].storedprofile!==1){d+='<i class="fa fa-rss fa-wifi sx"></i>'}}}d+="<strong>"+e[g].ESSID+"</strong></a></p>";if(e[g].origin==="scan"){a+=d}if(e[g].storedprofile===1){c+=d}d=""});if(a===""){a='<p><a class="btn btn-lg btn-default btn-block" href="#"><i class="fa fa-cog fa-spin sx"></i>scanning for networks...</a></p>'}document.getElementById("wifiNetworks").innerHTML=a;document.getElementById("wifiStored").innerHTML=c;$.ajax({url:"/command/?cmd=wifiscan",cache:false})}function nicsDetails(d){var b=0,c="",a=d[0];$.each(a,function(e){if(e===$("#nic-details").data("name")){c+="<tr><th>Name:</th><td><strong>"+e+"<strong></td></tr>";c+="<tr><th>Type:</th><td>wireless</td></tr>";if(a[e].currentssid===null){c+='<tr><th>Status:</th><td><i class="fa fa-times red sx"></i>no network connected</td></tr>'}else{c+='<tr><th>Status:</th><td><i class="fa fa-check green sx"></i>connected</td></tr>';c+="<tr><th>Associated SSID:</th><td><strong>"+a[e].currentssid+"</strong></td></tr>"}c+="<tr><th>Assigned IP:</th><td>"+((a[e].ip!==null)?("<strong>"+a[e].ip+"</strong>"):"none")+"</td></tr>";c+="<tr><th>Speed:</th><td>"+((a[e].speed!==null)?a[e].speed:"unknown")+"</td></tr>";if(a[e].currentssid!==null){c+="<tr><th>Netmask:</th><td>"+a[e].netmask+"</td></tr>";c+="<tr><th>Gateway:</th><td>"+a[e].gw+"</td></tr>";c+="<tr><th>DNS1:</th><td>"+a[e].dns1+"</td></tr>";c+="<tr><th>DNS2:</th><td>"+a[e].dns2+"</td></tr>"}}});$("#nic-details tbody").html(c)}function playbackChannel(){var a=new PushStream({host:window.location.hostname,port:window.location.port,modes:GUI.mode,reconnectOnChannelUnavailableInterval:5000});a.onmessage=renderUI;a.onstatuschange=function(b){if(b===2){$("#loader").addClass("hide");sendCmd("renderui")}else{if(b===0){toggleLoader()}}};a.addChannel("playback");a.connect()}function queueChannel(){var a=new PushStream({host:window.location.hostname,port:window.location.port,modes:GUI.mode});a.onmessage=getPlaylist;a.addChannel("queue");a.connect()}function libraryChannel(){var a=new PushStream({host:window.location.hostname,port:window.location.port,modes:GUI.mode});a.onmessage=libraryHome;a.addChannel("library");a.connect()}function notifyChannel(){var a=new PushStream({host:window.location.hostname,port:window.location.port,modes:GUI.mode});a.onmessage=renderMSG;a.addChannel("notify");a.connect()}function wlansChannel(){var a=new PushStream({host:window.location.hostname,port:window.location.port,modes:GUI.mode});a.onmessage=listWLANs;a.addChannel("wlans");a.connect();$.ajax({url:"/command/?cmd=wifiscan",cache:false})}function nicsChannel(){var a=new PushStream({host:window.location.hostname,port:window.location.port,modes:GUI.mode});a.onmessage=nicsDetails;a.addChannel("nics");a.connect()}function overlayTrigger(d){var c=$(d),e=$(d+"-open"),b=$(d+"-close");transEndEventNames={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd",msTransition:"MSTransitionEnd",transition:"transitionend"};function a(){if(c.hasClass("open")){c.removeClass("open");c.addClass("closed");var i=function(j){if(support.transitions){if(j.propertyName!=="visibility"){return}this.removeEventListener(transEndEventName,i)}c.removeClass("closed")}}else{if(c.hasClass("closed")){c.addClass("open");if(d==="#overlay-social"){var h="https://twitter.com/home?status=Listening+to+"+GUI.json.currentsong.replace(/\s+/g,"+")+"+by+"+GUI.json.currentartist.replace(/\s+/g,"+")+"+on+%40RuneAudio+http%3A%2F%2Fwww.runeaudio.com%2F+%23nowplaying";var g="https://www.facebook.com/sharer.php?u=http%3A%2F%2Fwww.runeaudio.com%2F&display=popup";var f="https://plus.google.com/share?url=http%3A%2F%2Fwww.runeaudio.com%2F";$("#urlTwitter").attr("href",h);$("#urlFacebook").attr("href",g);$("#urlGooglePlus").attr("href",f)}}}}e.click(function(){a()});b.click(function(){a()})}function getHiddenProp(){var b=["webkit","moz","ms","o"];if("hidden" in document){return"hidden"}for(var a=0;a<b.length;a++){if((b[a]+"Hidden") in document){return b[a]+"Hidden"}}return null}function isHidden(){var a=getHiddenProp();if(!a){return false}return document[a]}function visChange(){if(isHidden()){GUI.visibility="hidden"}else{GUI.visibility="visible"}}if($("#section-index").length){jQuery(document).ready(function(f){GUI.mode=checkWebSocket();playbackChannel();libraryChannel();PNotify.prototype.options.styling="fontawesome";PNotify.prototype.options.stack.dir1="up";PNotify.prototype.options.stack.dir2="left";PNotify.prototype.options.stack.firstpos1=90;PNotify.prototype.options.stack.firstpos2=50;PNotify.prototype.options.stack.spacing1=10;PNotify.prototype.options.stack.spacing2=10;notifyChannel();var e=getHiddenProp();if(e){var a=e.replace(/[H|h]idden/,"")+"visibilitychange";document.addEventListener(a,visChange)}var g=f("#playlist-entries");g.on("click","li",function(i){var h="";var j=f("li","#playlist-entries").index(this);h="play "+j;sendCmd(h);f("li.active","#playlist-entries").removeClass("active");f(this).addClass("active")});f("a","#open-panel-dx").click(function(){if(f("#open-panel-dx").hasClass("active")){var h=parseInt(GUI.json.song);customScroll("pl",h,500);if(!f("#pl-filter-results").hasClass("hide")){f("#pl-filter-results").click()}}}).on("shown.bs.tab",function(i){var h=parseInt(GUI.json.song);customScroll("pl",h,0)});var d=document.getElementById("playlist-entries");new Sortable(d,{ghostClass:"sortable-ghost",onUpdate:function(h){sortOrder(h.item.getAttribute("id"))}});f("a","#open-panel-sx").click(function(){if(f("#open-panel-sx").hasClass("active")){customScroll("pl",parseInt(GUI.json.song),500)}}).on("shown.bs.tab",function(h){customScroll("db",GUI.currentDBpos[GUI.currentDBpos[10]],0)});f("#db-homeSetup").click(function(){var h=f(this);if(h.hasClass("btn-primary")){h.removeClass("btn-primary").addClass("btn-default");f(".home-block-remove").remove()}else{h.removeClass("btn-default").addClass("btn-primary");f(".home-block.home-bookmark").append('<div class="home-block-remove" title="Remove this bookmark"><span class="block-remove">&times;</span></div>')}});var b=f("#database-entries");b.on("click","li",function(m){var l="",k="";var j=f(this);f("li.active","#database-entries").removeClass("active");j.addClass("active");if(j.hasClass("db-folder")){l=j.data("path");if(j.hasClass("db-album")){if(l!==""){getDB({path:l,uplevel:0,browsemode:"album"})}else{l=GUI.currentDBpath[GUI.currentDBpos[10]-1];getDB({path:l,uplevel:0,browsemode:"albumfilter"})}}else{if(j.hasClass("db-artist")){getDB({path:l,uplevel:0,browsemode:"artist"})}else{if(j.hasClass("db-composer")){getDB({path:l,uplevel:0,browsemode:"composer"})}else{if(j.hasClass("db-genre")){getDB({path:l,uplevel:0,browsemode:"genre"})}else{if(j.hasClass("db-spotify")){l=GUI.currentpath+"/"+j.find("span").text();getDB({path:l,plugin:"Spotify",args:j.data("path").toString(),querytype:"tracks"});GUI.plugin="Spotify"}else{if(j.hasClass("db-dirble")){l=GUI.currentpath+"/"+j.find("span").text();var h=(j.hasClass("db-dirble-child"))?"stations":"childs";getDB({path:l,plugin:"Dirble",querytype:h,args:j.data("path")});GUI.plugin="Dirble"}else{if(j.hasClass("db-jamendo")){}else{k=j.data("browsemode");getDB({path:l,uplevel:0,browsemode:k})}}}}}}}var i=j.attr("id");i=i.replace("db-","");GUI.currentDBpos[GUI.currentDBpos[10]]=i;GUI.currentDBpath[GUI.currentDBpos[10]]=l;++GUI.currentDBpos[10]}else{if(j.hasClass("db-webradio-add")){f("#modal-webradio-add").modal()}}});b.on("dblclick","li",function(j){var h=f(this);if(!f(j.target).hasClass("db-action")){f("li.active","#database-entries").removeClass("active");h.addClass("active");var i=h.data("path");if(h.hasClass("db-spotify")){i=h.attr("data-plid")+"-"+h.attr("data-path");getDB({cmd:"spaddplay",path:i,querytype:"spotify-track"})}else{i=(h.hasClass("db-dirble"))?i.split(" | ")[1]:i;getDB({cmd:"addplay",path:i})}}});f("a",".context-menu").click(function(){var h=f(this).data("cmd");var i=f(this).data("type");var j=GUI.DBentry[0];GUI.DBentry[0]="";switch(h){case"pl-add":sendCmd('load "'+j+'"');break;case"pl-replace":sendCmd("clear");sendCmd('load "'+j+'"');break;case"pl-addreplaceplay":sendCmd("clear");sendCmd('load "'+j+'"');sendCmd("play");break;case"pl-ashuffle":f.post("/db/?cmd=pl-ashuffle",{playlist:j});f("#random").attr("data-cmd","pl-ashuffle-stop");f("#random").attr("title","Stop randomly adding songs");f("#random").addClass("btn-primary");break;case"wradd":j=j.split(" | ")[1];getDB({cmd:"add",path:j});break;case"wraddplay":j=j.split(" | ")[1];getDB({cmd:"addplay",path:j});break;case"wraddreplaceplay":j=j.split(" | ")[1];getDB({cmd:"addreplaceplay",path:j});break;default:getDB({cmd:h,path:j,browsemode:GUI.browsemode,querytype:i});break}});f("#db-firstPage").click(function(){f.scrollTo(0,500)});f("#db-prevPage").click(function(){var h="-="+f(window).height()+"px";f.scrollTo(h,500)});f("#db-nextPage").click(function(){var h="+="+f(window).height()+"px";f.scrollTo(h,500)});f("#db-lastPage").click(function(){f.scrollTo("100%",500)});f("#pl-firstPage").click(function(){f.scrollTo(0,500)});f("#pl-prevPage").click(function(){var i=f(window).scrollTop();var h=i-f(window).height();f.scrollTo(h,500)});f("#pl-nextPage").click(function(){var i=f(window).scrollTop();var h=i+f(window).height();f.scrollTo(h,500)});f("#pl-lastPage").click(function(){f.scrollTo("100%",500)});var c=document.location.toString();if(c.match("#")){f('#menu-bottom a[href="/#'+c.split("#")[1]+'"]').tab("show")}f("#menu-bottom a").on("shown",function(h){if(history.pushState){history.pushState(null,null,h.target.hash)}else{window.location.hash=h.target.hash}}).on("click",function(){if(f("#overlay-social").hasClass("open")){f(".overlay-close").trigger("click")}});if(f(".ttip").length){f(".ttip").tooltip()}FastClick.attach(document.body);f("#syscmd-poweroff").click(function(){f.post("/settings/",{syscmd:"poweroff"});toggleLoader()});f("#syscmd-reboot").click(function(){f.post("/settings/",{syscmd:"reboot"});toggleLoader()});f("#syscmd-display_off").click(function(){f.post("/settings/",{syscmd:"display_off"})});overlayTrigger("#overlay-social");overlayTrigger("#overlay-playsource");f("#playsource-spotify").click(function(){if(f(this).hasClass("inactive")){if(GUI.libraryhome.Spotify==="1"){GUI.forceGUIupdate=true;f.ajax({url:"/command/?switchplayer=Spotify",cache:false});f("#overlay-playsource-close").trigger("click")}else{new PNotify({title:"Spotify not enabled",text:"Enable and configure it under the Settings screen",icon:"fa fa-exclamation-circle"})}}});if(document.location.hostname=="localhost"){f(".osk-trigger").onScreenKeyboard({draggable:true})}})}else{jQuery(document).ready(function(d){GUI.mode=checkWebSocket();playbackChannel();PNotify.prototype.options.styling="fontawesome";PNotify.prototype.options.stack.dir1="up";PNotify.prototype.options.stack.dir2="left";PNotify.prototype.options.stack.firstpos1=90;PNotify.prototype.options.stack.firstpos2=50;PNotify.prototype.options.stack.spacing1=10;PNotify.prototype.options.stack.spacing2=10;notifyChannel();d(".btn-cmd").click(function(){var e=d(this);commandButton(e)});d("#syscmd-poweroff").click(function(){d.post("/settings/",{syscmd:"poweroff"});toggleLoader()});d("#syscmd-reboot").click(function(){d.post("/settings/",{syscmd:"reboot"});toggleLoader()});d("#syscmd-display_off").click(function(){d.post("/settings/",{syscmd:"display_off"})});d(".selectpicker").selectpicker();if(d("#section-sources").length){if(d("#mount-type").val()==="nfs"){d("#mount-cifs").addClass("disabled").children(".disabler").removeClass("hide")}d("#mount-type").change(function(){if(d(this).val()==="cifs"||d(this).val()==="osx"){d("#mount-cifs").removeClass("disabled").children(".disabler").addClass("hide")}else{d("#mount-cifs").addClass("disabled").children(".disabler").removeClass("hide")}});d("#nas-guest").change(function(){if(d(this).prop("checked")){d("#mount-auth").addClass("disabled").children(".disabler").removeClass("hide")}else{d("#mount-auth").removeClass("disabled").children(".disabler").addClass("hide")}});d("#nas-advanced").change(function(){if(d(this).prop("checked")){d("#mount-advanced-config").removeClass("hide")}else{d("#mount-advanced-config").addClass("hide")}});d("#show-mount-advanced-config").click(function(f){f.preventDefault();if(d(this).hasClass("active")){d("#mount-advanced-config").toggleClass("hide");d(this).removeClass("active");d(this).find("i").removeClass("fa fa-minus-circle").addClass("fa fa-plus-circle");d(this).find("span").html("show advanced options")}else{d("#mount-advanced-config").toggleClass("hide");d(this).addClass("active");d(this).find("i").removeClass("fa fa-plus-circle").addClass("fa fa-minus-circle");d(this).find("span").html("hide advanced options")}});d("#usb-mount-list a").click(function(){var e=d(this).data("mount");d("#usb-umount-name").html(e);d("#usb-umount").val(e)})}if(d("#section-settings").length){d("#airplay").change(function(){if(d(this).prop("checked")){d("#airplayName").removeClass("hide");d("#airplayBox").addClass("boxed-group")}else{d("#airplayName").addClass("hide");d("#airplayBox").removeClass("boxed-group")}});d("#scrobbling-lastfm").change(function(){if(d(this).prop("checked")){d("#lastfmAuth").removeClass("hide");d("#lastfmBox").addClass("boxed-group")}else{d("#lastfmAuth").addClass("hide");d("#lastfmBox").removeClass("boxed-group")}});d("#proxy").change(function(){if(d(this).prop("checked")){d("#proxyAuth").removeClass("hide");d("#proxyBox").addClass("boxed-group")}else{d("#proxyAuth").addClass("hide");d("#proxyBox").removeClass("boxed-group")}});d("#dlna").change(function(){if(d(this).prop("checked")){d("#dlnaName").removeClass("hide");d("#dlnaBox").addClass("boxed-group")}else{d("#dlnaName").addClass("hide");d("#dlnaBox").removeClass("boxed-group")}});d("#spotify").change(function(){if(d(this).prop("checked")){d("#spotifyAuth").removeClass("hide");d("#spotifyBox").addClass("boxed-group")}else{d("#spotifyAuth").addClass("hide");d("#spotifyBox").removeClass("boxed-group")}});d(".btn-file :file").on("fileselect",function(g,h,f){var e=d(this).parents(".input-group").find(":text");if(e.length){e.val(f)}else{if(f){console.log("Selected file: ",f);if(f.indexOf("backup_")>-1&&f.indexOf(".tar.gz")>-1){d("#backup-file").html(' <i class="fa fa-check dx green"></i> '+f+"");d("#btn-backup-upload").prop("disabled",false)}else{d("#backup-file").html(' <i class="fa fa-times dx red"></i> not a valid backup file');d("#btn-backup-upload").prop("disabled",true)}}}})}if(d("#section-network").length){var b=d("#network-manual-config");if(d("#dhcp").val()==="0"){b.removeClass("hide")}d("#dhcp").change(function(){if(d(this).val()==="0"){b.removeClass("hide")}else{b.addClass("hide")}});var c=d("#wifi-security-key");if(d("#wifi-security").val()!=="open"){c.removeClass("hide")}d("#wifi-security").change(function(){if(d(this).val()!=="open"){c.removeClass("hide")}else{c.addClass("hide")}});if(d("#wifiNetworks").length){wlansChannel();nicsChannel()}d("#wifiProfiles").change(function(){if(d(this).prop("checked")){d("#wifiProfilesBox").addClass("hide")}else{d("#wifiProfilesBox").removeClass("hide")}})}if(d("#section-accesspoint").length){d("#accesspoint").change(function(){if(d(this).prop("checked")){d("#accesspointSettings").removeClass("hide");d("#accesspointBox").addClass("boxed-group")}else{d("#accesspointSettings").addClass("hide");d("#accesspointBox").removeClass("boxed-group")}});d("#ip-address").change(function(){var e=d("#ip-address").val().split(".");e[3]++;d("#dhcp-range").val(e.join(".")+","+e[0]+"."+e[1]+"."+e[2]+".254,24h");e[3]=255;d("#broadcast").val(e.join("."));d("#dhcp-option-dns").val(d("#ip-address").val());d("#dhcp-option-router").val(d("#ip-address").val())})}if(d("#section-mpd").length){d("#audio-output-interface").change(function(){renderMSG([{title:"Switching audio output",text:"Please wait for the config update...",icon:"fa fa-cog fa-spin",delay:5000}]);var e=d(this).val();d.ajax({type:"POST",url:"/mpd/",data:{ao:e},cache:false})});d(".manual-edit-confirm").find(".btn-primary").click(function(){d("#mpdconf_editor").removeClass("hide");d("#manual-edit-warning").addClass("hide")})}if(d("#section-debug").length){ZeroClipboard.config({swfPath:"/assets/js/vendor/ZeroClipboard.swf"});var a=new ZeroClipboard(document.getElementById("copy-to-clipboard"));a.on("ready",function(e){a.on("aftercopy",function(f){new PNotify({title:"Copied to clipboard",text:"The debug output was copied successfully in your clipboard.",icon:"fa fa-check"})})})}if(document.location.hostname=="localhost"){d(".osk-trigger").onScreenKeyboard({draggable:true})}});$(document).on("change",".btn-file :file",function(){var a=$(this),c=a.get(0).files?a.get(0).files.length:1,b=a.val().replace(/\\/g,"/").replace(/.*\//,"");a.trigger("fileselect",[c,b])})};